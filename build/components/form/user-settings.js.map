{"version":3,"sources":["user-settings.js"],"names":["BUTTON_WIDTH","UserSettings","props","user","toggleTracking","trackRecent","hasRecents","recentPlaces","length","recentSearches","window","confirm","locations","find","l","type","push","id","icon","name","blank","storageDisclaimer","favoriteStops","_getLocations","order","sortedLocations","sort","a","b","indexOf","padding","map","location","timestamp","search","_enableTracking","_disableTracking","Component","Place","query","setLocation","alert","to","from","setViewedStop","stopId","forgetPlace","forgetStop","showView","_isViewable","showForget","_isForgettable","offset","width","_onSelect","_onView","_onForget","RecentSearch","setQueryParam","forgetSearch","fromNow","whiteSpace","overflow","textOverflow","textAlign","paddingTop","mapStateToProps","state","ownProps","config","otp","currentPosition","nearbyStops","currentQuery","sessionSearches","stopsIndex","transitIndex","stops","language","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport moment from 'moment'\nimport { Button } from 'react-bootstrap'\n\nimport Icon from '../narrative/icon'\nimport { forgetSearch, toggleTracking } from '../../actions/api'\nimport { setQueryParam } from '../../actions/form'\nimport { forgetPlace, forgetStop, setLocation } from '../../actions/map'\nimport { setViewedStop } from '../../actions/ui'\nimport { getDetailText, formatStoredPlaceName, matchLatLon } from '../../util/map'\nimport { summarizeQuery } from '../../util/query'\n\nconst BUTTON_WIDTH = 40\n\nclass UserSettings extends Component {\n  _disableTracking = () => {\n    const { user, toggleTracking } = this.props\n    if (!user.trackRecent) return\n    const hasRecents = user.recentPlaces.length > 0 || user.recentSearches.length > 0\n    // If user has recents and does not confirm deletion, return without doing\n    // anything.\n    if (hasRecents && !window.confirm('You have recent searches and/or places stored. Disabling storage of recent places/searches will remove these items. Continue?')) {\n      return\n    }\n    // Disable tracking if we reach this statement.\n    toggleTracking(false)\n  }\n\n  _enableTracking = () => !this.props.user.trackRecent && this.props.toggleTracking(true)\n\n  _getLocations = (user) => {\n    const locations = [...user.locations]\n    if (!locations.find(l => l.type === 'work')) {\n      locations.push({\n        id: 'work',\n        type: 'work',\n        icon: 'briefcase',\n        name: 'click to add',\n        blank: true\n      })\n    }\n    if (!locations.find(l => l.type === 'home')) {\n      locations.push({\n        id: 'home',\n        type: 'home',\n        icon: 'home',\n        name: 'click to add',\n        blank: true\n      })\n    }\n    return locations\n  }\n\n  render () {\n    const { storageDisclaimer, user } = this.props\n    const { favoriteStops, trackRecent, recentPlaces, recentSearches } = user\n    // Clone locations in order to prevent blank locations from seeping into the\n    // app state/store.\n    const locations = this._getLocations(user)\n    const order = ['home', 'work', 'suggested', 'stop', 'recent']\n    const sortedLocations = locations\n      .sort((a, b) => order.indexOf(a.type) - order.indexOf(b.type))\n    return (\n      <div className='user-settings'>\n        <ul style={{ padding: 0 }}>\n          {sortedLocations.map(location => {\n            return <Place key={location.id} location={location} {...this.props} />\n          })}\n        </ul>\n        <hr />\n        <div className='section-header'>Favorite stops</div>\n        <ul style={{ padding: 0 }}>\n          {favoriteStops.length > 0\n            ? favoriteStops.map(location => {\n              return <Place key={location.id} location={location} {...this.props} />\n            })\n            : <small>No favorite stops </small>\n          }\n        </ul>\n        {trackRecent && recentPlaces.length > 0 &&\n          <div className='recent-places-container'>\n            <hr />\n            <div className='section-header'>Recent places</div>\n            <ul style={{ padding: 0 }}>\n              {recentPlaces.map(location => {\n                return <Place key={location.id} location={location} {...this.props} />\n              })}\n            </ul>\n          </div>\n        }\n        {trackRecent && recentSearches.length > 0 &&\n          <div className='recent-searches-container'>\n            <hr />\n            <div className='section-header'>Recent searches</div>\n            <ul style={{ padding: 0 }}>\n              {recentSearches\n                .sort((a, b) => b.timestamp - a.timestamp)\n                .map(search => {\n                  return <RecentSearch key={search.id} search={search} {...this.props} />\n                })\n              }\n            </ul>\n          </div>\n        }\n        <hr />\n        <div className='remember-settings'>\n          <div className='section-header'>My preferences</div>\n          <small>Remember recent searches/places?</small>\n          <Button\n            onClick={this._enableTracking}\n            className={trackRecent ? 'active' : ''}\n            bsSize='xsmall'\n            bsStyle='link'>Yes</Button>\n          <Button\n            onClick={this._disableTracking}\n            className={!trackRecent ? 'active' : ''}\n            bsSize='xsmall'\n            bsStyle='link'>No</Button>\n        </div>\n        {storageDisclaimer &&\n          <div>\n            <hr />\n            <div className='disclaimer'>\n              {storageDisclaimer}\n            </div>\n          </div>\n        }\n      </div>\n    )\n  }\n}\n\nclass Place extends Component {\n  _onSelect = () => {\n    const { location, query, setLocation } = this.props\n    if (location.blank) {\n      window.alert(`Enter origin/destination in the form (or set via map click) and click the resulting marker to set as ${location.type} location.`)\n    } else {\n      // If 'to' not set and 'from' does not match location, set as 'to'.\n      if (!query.to && (!query.from || !matchLatLon(location, query.from))) setLocation({ type: 'to', location })\n      // Vice versa for setting as 'from'.\n      else if (!query.from && !matchLatLon(location, query.to)) setLocation({ type: 'from', location })\n    }\n  }\n\n  _onView = () => {\n    const { location, setViewedStop } = this.props\n    setViewedStop({ stopId: location.id })\n  }\n\n  _onForget = () => {\n    const { forgetPlace, forgetStop, location } = this.props\n    if (location.type === 'stop') forgetStop(location.id)\n    else forgetPlace(location.id)\n  }\n\n  _isViewable = () => this.props.location.type === 'stop'\n\n  _isForgettable = () =>\n    ['stop', 'home', 'work', 'recent'].indexOf(this.props.location.type) !== -1\n\n  render () {\n    const { location } = this.props\n    const { blank, icon } = location\n    const showView = this._isViewable()\n    const showForget = this._isForgettable() && !blank\n    // Determine how much to offset width of main button (based on visibility of\n    // other buttons sharing the same line).\n    let offset = 0\n    if (showView) offset += BUTTON_WIDTH\n    if (showForget) offset += BUTTON_WIDTH\n    return (\n      <li className='place-item'>\n        <Button\n          bsStyle='link'\n          title={formatStoredPlaceName(location)}\n          className='place-button'\n          style={{ width: `calc(100% - ${offset}px)` }}\n          onClick={this._onSelect}>\n          <span\n            className='place-text'>\n            <Icon type={icon} /> {formatStoredPlaceName(location, false)}\n          </span>\n          <span\n            className='place-detail'>\n            {getDetailText(location)}\n          </span>\n        </Button>\n        {showView &&\n          <Button\n            onClick={this._onView}\n            className='place-view'\n            bsSize='xsmall'\n            title='View stop'\n            style={{ width: `${BUTTON_WIDTH}px` }}\n            bsStyle='link'><Icon type='search' /></Button>\n        }\n        {showForget &&\n          <Button\n            onClick={this._onForget}\n            className='place-clear'\n            bsSize='xsmall'\n            style={{ width: `${BUTTON_WIDTH}px` }}\n            bsStyle='link'>Clear</Button>\n        }\n      </li>\n    )\n  }\n}\n\nclass RecentSearch extends Component {\n  _onSelect = () => {\n    const { search, setQueryParam } = this.props\n    // Update query params and initiate search.\n    setQueryParam(search.query, search.id)\n  }\n\n  _onForget = () => this.props.forgetSearch(this.props.search.id)\n\n  render () {\n    const { search, user } = this.props\n    const { query, timestamp } = search\n    const name = summarizeQuery(query, user.locations)\n    return (\n      <li className='place-item'>\n        <Button\n          bsStyle='link'\n          title={`${name} (${moment(timestamp).fromNow()})`}\n          style={{\n            padding: '5px 0 0 0',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            textAlign: 'left',\n            width: `calc(100% - ${BUTTON_WIDTH}px)`\n          }}\n          onClick={this._onSelect}>\n          <span className='place-text'><Icon type='clock-o' /> {name} </span>\n          <span className='place-detail'>{moment(timestamp).fromNow()}</span>\n        </Button>\n        <Button\n          onClick={this._onForget}\n          bsSize='xsmall'\n          style={{ paddingTop: '6px', width: `${BUTTON_WIDTH}px` }}\n          bsStyle='link'>Clear</Button>\n      </li>\n    )\n  }\n}\n\n// connect to redux store\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    config: state.otp.config,\n    currentPosition: state.otp.location.currentPosition,\n    nearbyStops: state.otp.location.nearbyStops,\n    query: state.otp.currentQuery,\n    sessionSearches: state.otp.location.sessionSearches,\n    stopsIndex: state.otp.transitIndex.stops,\n    storageDisclaimer: state.otp.config.language.storageDisclaimer,\n    user: state.otp.user\n  }\n}\n\nconst mapDispatchToProps = {\n  forgetStop,\n  forgetPlace,\n  forgetSearch,\n  setLocation,\n  setQueryParam,\n  setViewedStop,\n  toggleTracking\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSettings)\n"]}