{"version":3,"sources":["trip-viewer.js"],"names":["TripViewer","props","setViewedTrip","findTrip","tripId","viewedTrip","hideBackButton","languageConfig","timeFormat","tripData","_backClicked","tripViewer","clear","route","shortName","longName","wheelchairAccessible","bikesAllowed","stops","stopTimes","map","stop","i","stripMapLineClass","length","highlightClass","fromIndex","toIndex","scheduledDeparture","id","name","Component","PropTypes","bool","object","mapStateToProps","state","ownProps","otp","ui","config","language","transitIndex","trips","mapDispatchToProps","setLocation"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { Button, Label } from 'react-bootstrap'\nimport { connect } from 'react-redux'\n\nimport Icon from '../narrative/icon'\nimport ViewStopButton from './view-stop-button'\n\nimport { setViewedTrip } from '../../actions/ui'\nimport { findTrip } from '../../actions/api'\nimport { setLocation } from '../../actions/map'\n\nimport { formatSecondsAfterMidnight, getTimeFormat } from '../../util/time'\n\nclass TripViewer extends Component {\n  static propTypes = {\n    hideBackButton: PropTypes.bool,\n    tripData: PropTypes.object,\n    viewedTrip: PropTypes.object\n  }\n\n  _backClicked = () => {\n    this.props.setViewedTrip(null)\n  }\n\n  componentWillMount () {\n    this.props.findTrip({tripId: this.props.viewedTrip.tripId})\n  }\n\n  render () {\n    const {\n      hideBackButton,\n      languageConfig,\n      timeFormat,\n      tripData,\n      viewedTrip\n    } = this.props\n\n    return (\n      <div className='trip-viewer'>\n        {/* Header Block */}\n        <div className='trip-viewer-header'>\n          {/* Back button */}\n          {!hideBackButton && (\n            <div className='back-button-container'>\n              <Button\n                bsSize='small'\n                onClick={this._backClicked}\n              ><Icon type='arrow-left' />Back</Button>\n            </div>\n          )}\n\n          {/* Header Text */}\n          <div className='header-text'>\n            {languageConfig.tripViewer || 'Trip Viewer'}\n          </div>\n          <div style={{ clear: 'both' }} />\n        </div>\n\n        <div className='trip-viewer-body'>\n          {/* Basic Trip Info */}\n          {tripData && (\n            <div>\n              {/* Route name */}\n              <div>Route: <b>{tripData.route.shortName}</b> {tripData.route.longName}</div>\n\n              {/* Wheelchair/bike accessibility badges, if applicable */}\n              <h4>\n                {tripData.wheelchairAccessible === 1 &&\n                  <Label bsStyle='primary'>\n                    <Icon type='wheelchair-alt' /> Accessible\n                  </Label>\n                }\n                {' '}\n                {tripData.bikesAllowed === 1 &&\n                  <Label bsStyle='success'>\n                    <Icon type='bicycle' /> Allowed\n                  </Label>\n                }\n              </h4>\n            </div>\n          )}\n\n          {/* Stop Listing */}\n          {tripData && tripData.stops && tripData.stopTimes && (\n            tripData.stops.map((stop, i) => {\n              // determine whether to use special styling for first/last stop\n              let stripMapLineClass = 'strip-map-line'\n              if (i === 0) stripMapLineClass = 'strip-map-line-first'\n              else if (i === tripData.stops.length - 1) stripMapLineClass = 'strip-map-line-last'\n\n              // determine whether to show highlight in strip map\n              let highlightClass\n              if (i === viewedTrip.fromIndex) highlightClass = 'strip-map-highlight-first'\n              else if (i > viewedTrip.fromIndex && i < viewedTrip.toIndex) highlightClass = 'strip-map-highlight'\n              else if (i === viewedTrip.toIndex) highlightClass = 'strip-map-highlight-last'\n\n              return (\n                <div key={i}>\n                  {/* the departure time */}\n                  <div className='stop-time'>\n                    {formatSecondsAfterMidnight(tripData.stopTimes[i].scheduledDeparture, timeFormat)}\n                  </div>\n\n                  {/* the vertical strip map */}\n                  <div className='strip-map-container'>\n                    { highlightClass && <div className={highlightClass} /> }\n                    <div className={stripMapLineClass} />\n                    <div className='strip-map-icon'><Icon type='circle' /></div>\n                  </div>\n\n                  {/* the stop-viewer button */}\n                  <div className='stop-button-container'>\n                    <ViewStopButton stopId={stop.id} text='View' />\n                  </div>\n\n                  {/* the main stop label */}\n                  <div className='stop-name'>\n                    {stop.name}\n                  </div>\n\n                  <div style={{ clear: 'both' }} />\n\n                </div>\n              )\n            })\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const viewedTrip = state.otp.ui.viewedTrip\n  return {\n    languageConfig: state.otp.config.language,\n    timeFormat: getTimeFormat(state.otp.config),\n    tripData: state.otp.transitIndex.trips[viewedTrip.tripId],\n    viewedTrip\n  }\n}\n\nconst mapDispatchToProps = {\n  setViewedTrip,\n  findTrip,\n  setLocation\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TripViewer)\n"]}